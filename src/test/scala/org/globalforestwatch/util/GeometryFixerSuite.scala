package org.globalforestwatch.util

import geotrellis.vector.{LineString, Polygon}
import org.globalforestwatch.util.GeotrellisGeometryValidator.makeValidGeom
import org.scalatest.funsuite.AnyFunSuite

class GeometryFixerSuite extends AnyFunSuite {

  test("delete me daddy") {
    val wkb = "0106000000020000000103000000020000005702000080BDBF7EDEF71F40B0980C9281804940C04D29CBEAF71F4047AF43F881804940C0D74D542FF81F40283B7F458480494080391ECE24F91F4040AA0B2C8B80494000096EEB41F91F4080ABAC428A804940005AF52677F91F4029C45A518A8049408031F7F119FA1F40F07393BD8A804940C01670341FFA1F4087C655CA8A8049408006E97D71FA1F406198C9938B8049404073FA2106FB1F4017F0A4858B80494080E863E81FFB1F4068FD25FD8B8049404087BED231FB1F40708EC44F8C8049408171A2D74BFB1F40908B44B78A80494000A14AA29EFB1F40507C16CD8880494000891E93EDFB1F40086485AE868049404048BBB82AFC1F40000B4F0B85804940C0E186663EFC1F4028FC6A9288804940C05C99F24CFC1F40F0B80C658C8049400039689D5BFC1F408F06F2848F80494080B36C8567FC1F4009D30E24948049400044C61A63FC1F4020874BA597804940C0CCF42245FC1F40AFB12F6C9C80494040ED66BD4DFC1F4040C5ADF9A680494000B5151268FC1F40D053D80AAF804940808E09246DFC1F402815B031B08049400039FCB790FC1F408820D6A1AE8049408015C6CFACFC1F409853A45DAD804940807A6BA2C7FC1F4017A39317AC804940402EE30EEAFC1F4088AAF2B9AA804940C064A67F0CFD1F4031FCAE42A9804940C0311E083DFD1F40A0F97F1CA7804940009F68AA69FD1F4028D47141A58049404067D11095FD1F40F0C2CA66A3804940C08215E4BDFD1F4000E5F9BDA18049403F196264E5FD1F4059656F2EA0804940407291BA1EFE1F40CF4BE58A9E80494080DC4F055DFE1F4090D4EA349D804940C0E990F499FE1F40A829CA5E9C804940000F99A1DAFE1F40505C49F09B804940C06F7A7A19FF1F40F9D211B69B80494040E8B9BD58FF1F40B9D0C3AD9B804940C0454BC596FF1F4077C21DA59B80494040D07458DCFF1F40E8218A9E9B8049408051AAE71E002040682137B99B804940E0C38FCC4B002040F96874EB9B80494080FA98815D002040700C29F59B804940807DE0166B002040D83328609C8049408087BF266B00204098138E6F9B804940A0C3222B64002040183160F495804940E0A5D06A620020402826A79794804940C02E7DA867002040E844157A9480494060262A656300204080C9F82A8B8049408011BF9F70002040603B56CB8B804940209693257A002040285EB56A8B804940A0AD7A0F83002040619C0CBC8A804940C04463048C002040F0902B8D8980494040ECFE3291002040D0A6AF298880494080983CA09700204078FB0E1387804940C08EA5B4A300204070088B808680494000483AA5B1002040905DEC078680494000149C7BC100204090200CDE85804940A038D658D1002040EF885AD28580494060A00E7FDB0020404093B68B85804940E0619BADEC00204020D720158480494080B7A6AB01012040F8F9A3A08280494040B4A8660E0120409033DEA78180494000E5E78E1701204017BDB3E07F804940A044752E1D012040308CA5C97E80494000101CF029012040700DEF837D804940004685083D01204048E5C0F47B80494060C01D525301204010CE83357A8049404046491A6C0120408810C78F788049402070F59483012040E785398377804940009F9BE79C012040D0222BF7768049404001128FBC0120402FC9526F7680494000729A03D9012040A8EB34657680494060CF22B8EA01204090F5923B7680494060BD19A2FB01204038CAFE3C778049400022975B01022040F11B9B9477804940C0A15A98130220404F10489E78804940206B00552D022040D82F17DF7A8049404089361147022040102796EC7C804940808D919158022040C0CA2D5C7F804940809E125969022040E018929882804940C005CED07A02204060C43C6D858049404029DE38910220407F5DD5458980494080587D8FA9022040A0D096068D804940A0FCC931BC022040D0DB5DDC90804940407A8BADBE02204078B4635091804940C0D12B12D1022040FF369AAF94804940C02B6ACDE2022040589C86EF97804940E0914562CE022040E08B9EE499804940E0778FC4AF022040972F10209D80494020632CBC930220402F4B6FDD9F804940C002E8767D02204068426B69A1804940800F0A965F022040E033FD72A38049400002FD6F39022040201D2E11A6804940A098B92310022040D837B860A8804940A02A3CC8E801204080BF007EAA804940C0B845C1D5012040F8560C40AB80494060322D1CCE0120402F7F5EBBAB8049404046259BC901204038BDBF9FAC80494000C4D680C9012040B99BB6D2AD804940E0D3AC52CB012040E80C6ED3AE80494060D3CFEAD001204051EE8509B080494060933D0FDC012040E8CF4F8FB2804940E038BDC0E901204070C2612FB5804940005B9D64F70120408FD70236B880494040CB328C070220408066BA8BBB804940206ABFB513022040880BCCB9BD804940206DBD3C2302204050DEF4BFC0804940E0F67C282C02204030673662C280494060870C8D2202204039B8E1D5C4804940E03DEF6358022040685E4062CD804940E077D54F74022040E8CD23E4DB804940C054C2137A022040281C1C87E280494040DBD32464022040A93A80F2F58049400049FF7C6F022040AFCBA1C6F6804940A023F58275022040F1B30666FA804940A0306E3866022040B0B0EC5EFB804940006CC1B83F02204088379E4E00814940600213132F0220408069834602814940C0D42A760B02204020249C670381494020278754F3012040999C0CC10381494080875F21DB012040C8EB60E804814940A0AA6533D3012040990C35B40881494040A8AD46B3012040A833160B0B814940604776D59E012040D8380E9B0C8149408055987F73012040F8CA0C530F814940609BC83E5B0120408062F2E010814940C0F5090343012040518B1FA21281494080249E93AE012040E08076C4F7804940A0B8D4FC89012040774CC3AEF580494040F49A8E68012040581E7B95F3804940E0D7E04F1D0120405088F5BDFB804940E0CA9EB3EE00204068CBBC390281494040DE5DA1EE002040D063700E03814940E0581168C200204010FD57E605814940E06EC465A500204030A11E4F09814940C08A2C508D002040E08838540E814940E02E4BE07B002040689D6FB314814940C0FE8A8D5D002040704BA6D5138149400038ADF03B00204078EFF7E4118149406039E8DD1B002040C81A67D3118149404099A59529002040205FBFF022814940A03F98AE3C00204098FF249930814940A01C596149002040A8B4D83C3A814940000E54DF5C002040504C14174381494060CC4F8B7000204051E122134A8149408012A039FA0020401091E67153814940C0E9C7E79401204030DCC8C85B814940A0D774F8FC01204038926D7B63814940804D38D050022040B071AF996A8149406072D549710220402862A1DB6D814940809D80DFEC0220405075DC1E7481494040D54DB55803204097DB90C87C814940204BB31BAB032040E082B2E482814940802F3D9CEB03204040701E868A814940200E7ECE1C04204048809F808C8149406041E21791042040488C17D891814940002334D88D042040078F3DB599814940C0D9A68586042040502686689D814940E02A94CE850420402037DE18A081494080053BD58C042040006839E2A6814940E006FFD991042040E9C843ACAC814940C08FCAFE8D042040F90BA7B3B081494080EEF83B8304204087D90A88B381494080979C9143042040606F2FC4C5814940E088EF571004204050DDB1B2DF81494060869DDBE4032040B884D9F7ED814940A092ABC0DF032040DF5FB86BF0814940C04F8A47C303204078E7987FF6814940C0C83DA4B203204068931C4D01824940A093531F6E032040F050376444824940A0358A1C8A03204020B16F574A824940800F508EC003204017CBB29C4E824940208C8794F2032040D8EF53395382494080CBEE0627042040886E63115582494060F5ABD35D042040E7D9282F5582494040375C07AE042040C0ECDA553D824940803AF21C9E04204090A80C2D3C824940C0069D1AAC042040A8CF7098228249400028D363B9042040109D314811824940A0A15593CB04204051AEC71C02824940200F6169D104204037FA3E0DF9814940A0540E5631052040187E4675FC814940008962434E052040895C59D7E581494040F954B85F0520403010B035DF81494040CDE2DC5E052040E8AC6DFCDC81494000184F8B61052040B0793E38DC814940406B231D6C05204098AC13CFCD8149408079FE177C05204078502778C1814940E08B2CFC8D05204090E691D7B4814940A060A54D980520403060E25FA9814940C0E7445F9A052040F8FE4206A781494000322C81BF0520402FC883B8A8814940A097F492270620402788029CAF81494060144CF597062040D93B0A47B88149402048C2BE9D062040406C35CDB68149404067CD3406072040F0FCD562BE81494000E769CD4A07204099670F35C3814940C088E40872072040C8CA53B6C5814940406F2C749A07204088643002C781494020BEF7A404082040F0E04219C8814940E08DFBC63F082040E091A165C88149408075E448670820408F29A270C7814940203F12D897082040F092E89AC6814940C056F42EAE082040A7B098CCC9814940A0EB190EC00820405873745ACC814940200CEC1AF508204070BEA1F5D2814940E0581F4928092040D91878B1DA81494000AD3A313F09204048A5E6B2DE814940A08C2E9F470920409F3D39A5E4814940E0326CB04A092040393A6895EA81494020C41B0E55092040A84CC4D7EE814940208AA62D5A092040B8CFF5ADF1814940006B039B66092040209D238DF2814940C015F5C86D092040E03A9448F2814940C0EBD6197C092040C8AA9D08F2814940A0FFB88D9E092040C8A3BB5B018249406086D98799092040A815D293128249404026B39D96092040E8CB6CD91F82494080EBBC0794092040E035457329824940408E981393092040C8EBFFBE34824940C0834AA39C09204068B8FC524282494020C61C5FD609204040A90A3B3C8249408080A93E0E0A2040475BEDB236824940404F3D65440A20405826A25030824940800B79DE6F0A204050717E5829824940C0352718960A204051261D3B21824940206F2393C30A2040104304B91782494080FDADA4E20A2040E8B18C980F824940E052AC99030B204028A06557068249406015EA95240B204050862B86FC814940A02FA682520B2040181202EFED81494040DD0D44440B2040298E8B56ED814940C0A77345290B2040B89A4242EF81494040A921440E0B204060F5CDBEF1814940400C8A19F30A20401FEC05EDF5814940E081F4A0E20A2040B0F10FB1FA814940007644EBCC0A2040F17345C1FD81494020A14916BB0A204071DEDE26FD8149406030845F940A20409822A602F681494060F2D813800A20409860EEB6F2814940002E8E0C6A0A204098FD2224EF81494080E1A429350A20400856F38EE681494060A71315190A2040213000DBE1814940A0AA09C3FC092040D065DB1DDD81494040F267BCD009204018342865D581494040EDF96CAD092040D031E63CD0814940C0C8B6B37F09204070451A63C781494060ACCD1849092040A068ECF2BD814940C0CB320316092040014F3716B5814940E096917F0809204040E50AEFB281494080A1F088F30820403012E199AF814940C04E70DFDA08204060214198AB81494060BE1D04C4082040DF962074A781494080196A00AE082040C01218BDA3814940E0551DE68908204078B6A6979D814940404EF93363082040100185BC96814940400981434508204020CE10BC918149400066ED4C270820408F4342038D814940006AECEA0C082040D060EE28888149406047B1CAEF0720400885DD248481494000BCD2D4E0072040E950506E8181494040518843E007204088E2D4C27D814940C0F6AF3ADF072040611E1E6E79814940E068DCEFDE072040A02E364078814940E0643677DD072040107DC47074814940003B1438EB07204060DE663B7081494080CAE8C9FA07204038D31BC06B814940C08396EA0C082040C0535B6668814940C0A6580016082040B0AF489566814940C04A4CC41908204030A7AD7964814940E012C3BF1C08204060B319D060814940C05B8546100820404831F4806081494000519367FE0720407191899B6081494060FB4249FA07204030020FEB5181494020D087F2FB072040D004D0E348814940A0EA64ABF6072040F8ED40E447814940E0F427FEE30720404815E4254781494080FEEC42D107204090235DD34681494000F50616C207204090CDFAA6468149406077B4A4B507204020E7A23346814940407B6CDAAB072040EF7E7BC24581494080EDB52EA207204098D748E7438149408004859598072040F864E13241814940A02CCBE48F072040A036405C3E81494020497D91840720407811D3163B814940E080D5597907204087EE568C36814940C03317E87507204090C5526B3481494080C5DBA367072040C827341B3481494020F82D8E5807204037DB57163381494080240DC46B072040977F542D23814940C0E938197D0720407183C34014814940006C2AE67B0920400092722F248149400013E3A9050A2040D882697B2881494080C2B7C2510A2040A0F4F49A29814940A05D6182990A2040D89CCAA92A814940A084B5E5E70A2040685663342B81494060EE1D26FB0A204000131A562B814940C038AADA3B0B20402FE5A79E308149408079E178850B2040817804743581494020D4E8969C0B204018775B0D3C81494060ED79C9C20B204058BDE06640814940C0E1C53CD70B204098C873BA42814940A06D2097170C204078DCBF384C814940C0142D39210C2040D89C18395B814940E019468B7D0C2040C9AEA41760814940A0DDD8A2BB0C2040000633276181494040A951C4F90C2040DF0A51C061814940207301B6230D2040C016B0C15B81494060EA00C51E0D20401133360C50814940E004E0C5190D2040FF395AAF4B814940A086A752110D2040D0C19DF24581494080231EFDED0C204070D5E56940814940E0CC5F0AD70C2040FF2718CB3D8149404079111A7F0C2040B841E7B43581494060AB987F310C2040A8DA509931814940A004C0D6770B2040F0F3E96227814940A0D870C3B50A2040F08283881781494040AD49CEC10A2040B825B0DB1581494040874736E50A2040F8A3D4D713814940C0EEF742030B2040A8DB93A6128149402011FAB0160B2040B1B635FE1181494000AAC62C2A0B204050EB7FEB10814940806EC75F500B20401833A53C0D814940204FF066700B2040BFA902670981494000018570880B2040685E966206814940000E411F760B204028212B41048149402036633B590B2040492E9D1B0281494000F180F4450B2040381763F3008149400001A7C8380B2040D8B0358100814940E03D9E42200B2040300022A4FE804940408A9295010B2040E8C94AA0FC8049406077CEB1E40A2040B8D93379FA804940401F41D8C60A20400776CE4CF9804940C071908CAC0A20407107E1D9F7804940E0050459A00A2040D7826C33F7804940606D786D7B0A204080E1CF3CF58049406074C800620A2040E85028A6F380494040DA413E4B0A2040816335EEF1804940608759652F0A2040902A05D5ED8049406027BEDF0A0A2040F07FF009E8804940C04B431DEE092040B0A55C5BE4804940E0249750D8092040C87179A9E1804940E07943AAC009204060607F14E080494080EE5BF9A10920400885FB7ADE8049408098CEDF680920401129F51BDC804940E0AD946840092040A8E6FBE1DB804940C0D7F67B04092040EF82A3DFDC804940C08F555EB3082040E00CB65FDE804940C0E59DA38B082040282DD3D1DF804940A0D53A9247082040E0D4B96FE380494060FE43D426082040C0857751E5804940A0A995580508204010C5FCCDE58049402038322CD20720409F971D5EE780494000367B42A407204090FFA0CDE88049402031D826780720401862E019EA804940C0AA4F9A4F072040DFE878D9EA8049400076993422072040B85BCFD3EA804940E04A42E5090720402880FFA6EA80494060C2FEB8EB062040A828776FEA804940004D6949BC06204058AB3FC7E9804940003F4A10A106204098FDD695E980494000CBDFD1870620405812929FE98049406061FB5C7C0620406724AA73E980494020A5AD265C06204030A3335EEA804940C0CC62093B062040E0A26691EB804940A07589481F06204088F584C7EC80494000ABDA24F5052040900CC616EF80494000620CDFD405204018C70CB7F080494060ADCFC0BB0520407F84745AF2804940C0D144689C052040498E07D7F380494020C18A2374052040B8249905F5804940C07B84CA5A052040183A282EF5804940E0FACBC349052040183CA721F680494040814BDC37052040808AA714F780494000E93B9C1905204080766673F6804940402782C10005204041DF55FDF480494080A68458E404204050AC2061F3804940E0F8BC24C6042040B8219230F2804940A0B4D682A4042040E0132E28EF804940A0C09F8E85042040A7397445EC8049408044F9F46B04204059D72942E9804940409CE5CB6E0420401FCB464AE7804940A0CDD7716B042040F06CF1BEE48049408015FEEB60042040171E969BE2804940A066AB8655042040C804DC30E0804940600CCFCC45042040876C17A2DC80494040DAA1D63E042040707F755CDA804940A06B29713404204097E48FF5D68049400003D29624042040200419ABD48049400035D19B15042040F09F85A9D2804940201EB4381204204008E0CD8AD080494080E872391404204010252DDECD804940C07C81B913042040589C8337C980494080C5ACB4180420407F6D7B2AC380494060FC14DE1D042040996AA900BB804940E0252F814704204028A6369EB3804940804CCD206904204087F0961BB4804940E04DBAEB74042040D893F746B480494000C26D729A042040C1049612B8804940A0E531BEC004204090DA3B45BC8049408089DE3AE3042040D85670D5BB8049402006FD1011052040389E2236C1804940A030DFB02305204030D4AD80BD804940608B00023105204051A014EFB880494040F9A1D741052040D0D6D8CAB080494060F57CBE47052040F7846FABAA804940C02A7E3049052040D0E4EB6AA6804940804EAF853A052040CF5DE69CA180494000465C1C6F05204060D2ED99A3804940A091CF4CAC052040BF479FF1A58049400080F80DD405204058F3E90CA780494060A47C01F0052040778F8E73A7804940A0D979250D062040E02612D5A6804940E048DDD830062040E8391CDCA4804940A04B70E54A062040E8492D5CA280494040EA50E364062040A04A758AA0804940E00C8C0382062040D9DCB517A0804940A019ACD5AA06204079E4D20FA28049402069B1E1D70620403058B333A4804940205AC286190720406974ADAEA480494020DCE91D5A072040D8D690D1A4804940C0101DDC7F07204088936BDFA3804940205E244FBA072040B007296BA080494020523B59F007204030FBC1A29D80494020726B6018082040414690829B80494060995BC13908204040C690949B80494060DE826A58082040A9CF43179B804940206984197B08204019FF681998804940A0A50F378908204038FCBD6D96804940407E2E22A30820407851F17595804940809BB5F0C9082040087912859480494080E2F383ED082040683936939380494000F6DE1A030920405889D1C4928049402094AD0528092040786A20C38E80494040FA038544092040600D5DB188804940603B5BCB5A092040B8007B8C7F804940C0ABEEAA6A092040B7A3A1E1758049400046A0396C092040883FA3447080494060BB1A786C092040399FFD5F6D8049406098083F64092040102283C368804940A0AFD1CD59092040E81515FF6480494020ED3F3F47092040F0E804A95E804940E0610FDE38092040280770A356804940E04FDC2418092040904B94AB42804940A012CD06100920404908280A3D804940E00690830D092040D8F504293B8049406046F7D433092040FFD274733A804940201ADF1C5009204080E6873F3A804940203F72B760092040381E79483A80494020CADFE36A09204028302FF03780494080F5A51C6B09204060B4664F35804940E0481E646609204070D8B0253280494040F518B761092040B13CF7742E80494060B3C38359092040B0881C202D804940E0A6FC019509204038296BBF28804940E06210CF4709204060E6A0900C80494060B7E00AFD082040406345CB09804940C019CC78BE082040B7BBB80E07804940603CFBB8A0082040509683DB0580494040451ACBAA0820404084CF7B08804940A0DC69CBB608204000ED0A940C80494060103CBEBD08204001275CAE0F80494000A037ADC50820400026F5471380494020E822EB94082040D8BBF1BB17804940007F622565082040D8AA72AE1C80494020DF3A135B08204068082B0E1A80494040B3A0BB1A08204009E8E51A208049404069A34C00082040A8CA5A241C80494000764B7FEA072040A97879601E804940C0658C1EDE07204010AD4B831E80494060534AC381072040C87A5F391B804940E0EB28646D07204071C361692080494020AA5A265107204038FE13E22580494080BAC08740072040615480CC27804940A03B46C82C072040A0E8F4082A80494080E1D6D0120720408F4F04E82C8049408024A94FE90620405063DB0C31804940204B3151CE062040A12E1CEC338049400004BF36B00620401043EB1B37804940E08CBEE2A6062040997990103880494060CA794DAF0620409F1695D74180494040E342FFB3062040F838170F47804940C0339AB08B06204008D7EB6949804940A0A508A36B062040A0887B224B804940608ED8E764062040286CDDA54B8049404003E7EF5206204048BD153349804940C0BE4B672F0620400784FEF841804940C01F8DDD1A062040185379403B804940A0643D2C090620408075947136804940804E0BF61006204009A50F9A33804940001F07952006204060425BF42C8049408035C5C54C0620409F564B5327804940E09920D65A06204011B0A9A2218049406080B41B570620404864C21618804940202B71C42A06204060E1C98009804940C0808A36090620406F40ED520B804940E0AB70C1D505204098E5A4CA0C804940E0288251AC052040F89AF8B90D80494000DEF84A880520402053C7620F804940006C75BD5D052040503297931180494080F6DE4A3C052040A0CEE62212804940009B55BB00052040A8EDB3C513804940C0A25E1BEA042040B80254EF2B804940A0E0746F9E042040C0B39E103080494000E63CA57B042040289CCDE531804940209B63A11F04204030ACCB5E33804940A010B53FE00320402895F5AA3480494040065BCEA00320402071A4AD36804940A0A4676B5E032040C87A8AB937804940003F36BF1D03204087CE6CA336804940E0A8DDAF02032040606E7F1A36804940E03CF9C1E7022040C85814B33480494000071E7AB3022040A099C9D22F80494060FA63B09B022040B8E784332C8049400006211E5E022040D86853912480494000A2B8A13102204020FCFF6321804940A033A3D837022040A8B32D4C248049408078DDCFE701204040E7960C36804940007F57D6C6012040C1F04FB83D804940E0D9E6ECBB012040D0AF31453F804940802446B891012040AFDA1B3A4580494060E64D8FB701204008545C484C804940E0D516ABC10120401918DDA74E80494060FE07BBD50120404084DDEF5180494080F51FBDD401204008C5312D5280494060485594C4012040180FFD1A56804940E02ADAECAD012040812C68BA548049404085A3EB8F012040A8F23E475180494020AA7C3273012040681ECA014F804940A03A4E6C6601204000092A1A53804940E0CD3C5B350120400803036650804940209DC562060120408F1DC2354D8049400031EFE3FB002040F8E65CC94F80494080226129DC002040E899D6944E804940E0B14AC3D200204070BC985950804940C0A5A87CCD0020403FAB5BF651804940009A7823CD002040D8BEB20556804940006D50E7C9002040309F51CC5780494040E0F9A0C2002040B79007C25880494060FD1763BB002040477F468E5980494000B19B1CB5002040381585D75A80494040C9E1D0B10020405001551B5D804940802A3478AE002040382D552F608049406065BE4EAD0020405862D9F761804940E01F1F43B300204037D7376A64804940401E422FB8002040781648B36680494000A43300B9002040F15958566B804940E0557276B400204050D3F4676C804940C0E6F64EA9002040A031CA086F804940401D7CA096002040E8A4AD6D7180494080F577E47F002040D1A5DF287380494000397D5E6D00204058E2EFEE73804940807CC5D157002040AF1FA40C74804940C09230223D00204010CF86277480494080CE74C8300020402001389D74804940E0E24767260020408064F50C76804940E097A1E21900204018D6337578804940A0EA101905002040185A64A87B80494081D3A949F5FF1F40388608BE7D80494080AB6990E2FF1F4079880B827F80494080B4448AA8FF1F4010A457127F8049404067BC9658FF1F409FF5F0D27E80494040F24AF712FF1F40203865437E804940402F7088D7FE1F40D88216337E804940C07815EC9BFE1F40C87B32F27E80494080DA200F54FE1F40A850F1AD7F80494000D00D0604FE1F406F1CF6EA7F804940C03A514ABCFD1F40875DC6AD7F80494040E2B18370FD1F40A0B2FD457F80494080F74D6916FD1F40B0F34A877E8049400078CD4BC8FC1F40B8A326D17D80494040391910B2FC1F405007049D7D804940C082750A5CFC1F407134EA087D804940004A82A5F7FB1F40A1B241637C80494080D442789DFB1F40AF96734A7C804940804FD8F288FB1F40982BAE577C804940C16C1D3841FB1F40988110847C80494000C71047F1FA1F4018A80F6E7C80494000A9E020BCFA1F40375BB7E37B804940C0C989B378FA1F40D03139857A80494080822CA141FA1F400075A50079804940007D329906FA1F40289502D57680494080A5CF83C5F91F40E8D07F027480494081B06DD59EF91F403087EB58728049408027B0457AF91F40688D768670804940006AB9614BF91F40673120046F8049408074DD2E10F91F4008DD5CD16D804940412CB418E1F81F4048CC67716D804940C0D515EFA4F81F40B107909771804940401D521E73F81F4048719A1A75804940C0BBF3B749F81F407041C87C77804940C003CFA132F81F4019FA73B37A804940C1A9DD9D1FF81F40D0E102EC7D804940C0E44568FCF71F40F0992A278080494080BDBF7EDEF71F40B0980C928180494024000000C009E12C80062040F7818B5258814940C099B6389006204008B063F15581494040A975439C062040E7964D8852814940A0ADB2B9E10620400019E32B50814940609F95A2FF0620401061497A57814940C0F7BDE85307204021172AD953814940605A800264072040980F06E05781494040571B4A8A0720402874586056814940806839EC98072040895F4AC756814940603FDA9F8E072040308C21915A814940009EB9DD840720409FEEF2D05E814940C02D63407F072040F00737E462814940E08686B67D072040306F78286781494000259F548407204008CBB9306C814940603AEA858E072040F08B507B70814940C00B88E88E072040C0DC7CFD728149408065ED898A0720405FCE690C7681494080035D2683072040C042FE1D7A8149402079577F7C072040C984AF547C8149408094B83871072040C80E18FB7D814940207C0DA0630720402998FDC97E814940A0F3BC6A5107204080E1351F7F814940E043DD493C072040D127CB137F814940004C2EAD23072040D1E8EE777E81494020E7D6B50707204018B33DFE7B814940C03AC559FA06204000DEA2037A814940E05786CEF1062040B84B24367781494060E5B4A7E4062040A848950073814940E03452AAD50620407090E6886F81494000AD95EAB10620402F39321F68814940C038749EA40620406881866965814940409B3A6E7C0620404003CCE46A814940A05EB99761062040506E896662814940C016AE2D8D062040986AD6EE5E8149408060E43F86062040D0A20DB35C814940C009E12C80062040F7818B52588149400103000000010000003400000060DD724E1C0C2040E07BA1B55F814940806645C5190C204098538FC2628149402023D6B21A0C204038C009486581494080425383240C20405F3F80566A81494060A503BF310C2040817907666F814940E097FF0C460C2040381AD03D7181494060B3D2D44D0C204079C130987381494020626CC3560C204058D621977581494020B738E1600C2040B848AD0C7781494060BBBC066B0C2040A041F626788149408040EF53760C2040877A131379814940E0F7E3FB840C20409966098B7A81494080865F7A930C2040CF661E2B7E81494040F290A89E0C204010BE0988808149408042658CA70C2040C854CE3F838149406087F5F0AC0C2040788CFEAC8681494040F59A35B00C2040A096E77A88814940C07784E2AD0C204030E6B60389814940A0C41360A90C2040786144A58881494020764DCCA30C204048B42732878149406043CE149D0C2040A86870BE858149402051D485970C204030E1554B84814940E0F4DFDE900C204028C3D84C82814940A06BDD4F8B0C2040F015BCD98081494020A87A09800C2040E12A98637F81494020093569710C20408013DB8E7D814940202D0275600C204061BF6A167C8149408052BC2A4D0C2040085A0E827B814940E0F94607330C2040778C0F467B814940E0DF705E1D0C2040180387C47B814940A000D7B0070C2040C079FE427C81494020C82C8FF60B2040604FE61F7D814940E0E5B769E50B204058F7112A7E81494040CD057FD60B2040B827F9927F814940E01E6697BE0B2040204936E27F81494080B62C3E890B2040C8B5C1267E81494080FAAB1B7D0B2040E0BEDECF798149406038C1256A0B204099038818758149402046C796640B204028C22EA6738149408029A3DB5C0B2040283B0BEF7081494020888E1F550B2040F875E0096E814940000E24A6460B2040809BCD696A81494000E570A63C0B20401881685567814940A0FEB6E52B0B204078B258B363814940C01E1FBD790B2040D0B4841C5E814940E0BD7A218C0B2040883967CF5B814940C044C809AB0B20405FB5BC895981494020FD87B2BF0B2040F8C79D9A578149402021FDBCCA0B2040506EDF665B81494020DE424AF80B204088BB30F55A814940C0142D39210C2040D89C18395B81494060DD724E1C0C2040E07BA1B55F814940"
    val validGeom = makeValidGeom(wkb)
    info(validGeom.toText)
    assert(validGeom.isValid)
  }

  test("A 'bowtie' polygon") {
    val poly: Polygon = Polygon((0.0, 0.0), (0.0, 10.0), (10.0, 0.0), (10.0, 10.0), (0.0, 0.0))
    val validGeom = makeValidGeom(poly)
    info(poly.toText())
    info(validGeom.toText())

    assert(!poly.isValid)
    assert(validGeom.isValid)
  }

  test("Inner ring with one edge sharing part of an edge of the outer ring") {
    val outerRing = LineString((0.0, 0.0), (10.0, 0.0), (10.0, 10.0), (0.0, 10.0), (0.0, 0.0))
    val innerRing = LineString((5.0, 2.0), (5.0, 7.0), (10.0, 7.0), (10.0, 2.0), (5.0, 2.0))
    val poly: Polygon = Polygon(outerRing, innerRing)
    val validGeom = makeValidGeom(poly)

    assert(!poly.isValid)
    assert(validGeom.isValid)
    assert(validGeom.getGeometryType === poly.getGeometryType)
  }

  test("Dangling edge") {
    val poly: Polygon = Polygon((0.0, 0.0), (10.0, 0.0), (15.0, 5.0), (10.0, 0.0), (10.0, 10.0), (0.0, 10.0), (0.0, 0.0))
    val validGeom = makeValidGeom(poly)

    assert(!poly.isValid)
    assert(validGeom.isValid)
    assert(validGeom.getGeometryType === poly.getGeometryType)
  }


  test("Two adjacent inner rings") {
    val outerRing = LineString((0.0, 0.0), (10.0, 0.0), (10.0, 10.0), (0.0, 10.0), (0.0, 0.0))
    val innerRing1 = LineString((1.0, 1.0), (1.0, 8.0), (3.0, 8.0), (3.0, 1.0), (1.0, 1.0))
    val innerRing2 = LineString((3.0, 1.0), (3.0, 8.0), (5.0, 8.0), (5.0, 1.0), (3.0, 1.0))

    val poly: Polygon = Polygon(outerRing, innerRing1, innerRing2)
    val validGeom = makeValidGeom(poly)

    assert(!poly.isValid)
    assert(validGeom.isValid)
    assert(validGeom.getGeometryType === poly.getGeometryType)
  }

  test("Non overlapping Holes") {
    val outerRing = LineString((10.0, 90.0), (90.0, 90.0), (90.0, 10.0), (10.0, 10.0), (10.0, 90.0))
    val innerRing1 = LineString((80.0, 70.0), (30.0, 70.0), (30.0, 20.0), (30.0, 70.0), (80.0, 70.0))
    val innerRing2 = LineString((70.0, 80.0), (70.0, 30.0), (20.0, 30.0), (70.0, 30.0), (70.0, 80.0))

    val poly: Polygon = Polygon(outerRing, innerRing1, innerRing2)
    val validGeom = makeValidGeom(poly)

    assert(!poly.isValid)
    assert(validGeom.isValid)
    assert(validGeom.getGeometryType === poly.getGeometryType)
  }

  test("Polygon with an inner ring inside another inner ring") {
    val outerRing = LineString((0.0, 0.0), (10.0, 0.0), (10.0, 10.0), (0.0, 10.0), (0.0, 0.0))
    val innerRing1 = LineString((2.0, 8.0), (5.0, 8.0), (5.0, 2.0), (2.0, 2.0), (2.0, 8.0))
    val innerRing2 = LineString((3.0, 3.0), (4.0, 3.0), (3.0, 4.0), (3.0, 3.0))

    val poly: Polygon = Polygon(outerRing, innerRing1, innerRing2)
    val validGeom = makeValidGeom(poly)

    assert(!poly.isValid)
    assert(validGeom.isValid)
    assert(validGeom.getGeometryType === poly.getGeometryType)
  }

  test("Positive and negative overlap") {
    val poly: Polygon = Polygon((10.0, 90.0), (50.0, 90.0), (50.0, 30.0), (70.0, 30.0), (70.0, 50.0), (30.0, 50.0), (30.0, 70.0),
      (90.0, 70.0), (90.0, 10.0), (10.0, 10.0), (10.0, 90.0))
    val validGeom = makeValidGeom(poly)

    assert(!poly.isValid)
    assert(validGeom.isValid)
    assert(validGeom.getGeometryType === poly.getGeometryType)
  }

}
